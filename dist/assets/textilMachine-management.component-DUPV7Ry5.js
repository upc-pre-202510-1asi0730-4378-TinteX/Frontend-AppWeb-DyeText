import{D as N}from"./data-manager.component-CFoI-hvr.js";import{T as w,a as C}from"./textileMachine.entity-DI3Gu5sr.js";import{_ as M,c as r,a as t,t as i,F as u,r as m,n as f,f as _,v as F,o,g,h as A,i as I,j as y,s as V,b as k,e as T,k as S,d as v,w as x}from"./index-PoYZxlwP.js";import{T as D}from"./textilMachine-item-create.component-DPmM2jHN.js";import"./http.instance-t2F9Yq3_.js";import"./index-xsH4HHeE.js";import"./create-and-edit.component-WISuARUW.js";const B={name:"textilMachine-search-content",components:{DataManager:N},data(){return{machineName:"",textileMachines:[],textileMachineService:null,usedNumber:new Set,isFocused:!1,selectedStatus:null}},computed:{filteredMachines(){return this.machineName.toLowerCase()?this.textileMachines.filter(e=>e.number_machine.toLowerCase().includes(this.machineName.toLowerCase())||e.status.toLowerCase().includes(this.machineName.toLowerCase())||e.zone.toLowerCase().includes(this.machineName.toLowerCase())||e.asset_type.toLowerCase().includes(this.machineName.toLowerCase())||e.name.toLowerCase().includes(this.machineName.toLowerCase())):this.textileMachines},randomNumber(){let n=["min","hour","sec"],e,d=n[Math.floor(Math.random()*n.length)],c=0;if(d==="hour")do if(e=Math.floor(Math.random()*24),c++,c>100)break;while(this.usedNumber.has(e));else do if(e=Math.floor(Math.random()*60),c++,c>100)break;while(this.usedNumber.has(e));return this.usedNumber.add(e),{number:e,time:d}},uniqueZones(){const n=new Set;return this.textileMachines.map(e=>e.zone).filter(e=>n.has(e)?!1:(n.add(e),!0))},uniqueStatuses(){const n=new Set;return this.textileMachines.map(e=>e.status).filter(e=>n.has(e)?!1:(n.add(e),!0))},uniqueAssetType(){const n=new Set;return this.textileMachines.map(e=>e.asset_type).filter(e=>n.has(e)?!1:(n.add(e),!0))}},methods:{applyFilter(n){this.machineName=n}},created(){this.textileMachineService=new w,this.textileMachineService.getAll().then(n=>{this.textileMachines=n.data.map(e=>new C(e))}).catch(n=>{console.log(n)})}},P={class:"filter-search-container"},U={class:"filter-box"},z={class:"filter"},E={class:"filter-type"},R=["onClick"],Z={class:"filter"},j={class:"filter-type"},G=["onClick"],H={class:"filter"},J={class:"filter-type"},K=["onClick"],O={class:"search-box"},Q={class:"machines-summary"},W={class:"machines-summary-info"},X={class:"machines-summary-activity"};function Y(n,e,d,c,l,a){return o(),r("div",P,[t("div",U,[t("div",z,[t("h3",null,i(n.$t("monitoring.status")),1),t("div",E,[t("ul",null,[(o(!0),r(u,null,m(a.uniqueStatuses,s=>(o(),r("li",{key:s,onClick:h=>{l.selectedStatus=s,a.applyFilter(s)},class:f({active:l.selectedStatus===s})},i(s),11,R))),128))])])]),t("div",Z,[t("h3",null,i(n.$t("monitoring.asset-type")),1),t("div",j,[t("ul",null,[(o(!0),r(u,null,m(a.uniqueAssetType,s=>(o(),r("li",{key:s,onClick:h=>{l.selectedStatus=s,a.applyFilter(s)},class:f({active:l.selectedStatus===s})},i(s),11,G))),128))])])]),t("div",H,[t("h3",null,i(n.$t("monitoring.zone")),1),t("div",J,[t("ul",null,[(o(!0),r(u,null,m(a.uniqueZones,s=>(o(),r("li",{key:s,onClick:h=>{l.selectedStatus=s,a.applyFilter(s)},class:f({active:l.selectedStatus===s})},i(s),11,K))),128))])])])]),t("div",O,[t("form",null,[t("div",{class:f(["search-input-container",{focused:l.isFocused}])},[_(t("input",{class:"search","onUpdate:modelValue":e[0]||(e[0]=s=>l.machineName=s),placeholder:"search device",onFocus:e[1]||(e[1]=s=>l.isFocused=!0),onBlur:e[2]||(e[2]=s=>l.isFocused=!1),required:""},null,544),[[F,l.machineName]]),e[3]||(e[3]=t("i",{class:"pi pi-search"},null,-1))],2)]),t("h2",null,i(n.$t("monitoring.available-machines")),1),t("div",Q,[(o(!0),r(u,null,m(a.filteredMachines,s=>(o(),r("div",{class:"machines-summary-item",key:s.id},[t("div",W,[e[4]||(e[4]=t("i",{class:"pi pi-exclamation-circle"},null,-1)),t("div",null,[t("span",null,i(n.$t("machine"))+": "+i(s.number_machine),1),t("span",null,i(s.status),1)])]),t("div",X,[g(i(n.$t("monitoring.last-activity"))+": ",1),e[5]||(e[5]=t("br",null,null,-1)),g(" "+i(a.randomNumber.number)+" "+i(a.randomNumber.time),1)])]))),128))])])])}const ee=M(B,[["render",Y],["__scopeId","data-v-54d9132d"]]),te={name:"textile-machine-list",components:{PvCard:A},data(){return{showForm:!1,textileMachines:[],textileMachineService:null}},methods:{goToConfiguration(n){this.$router.push({name:"machine-configuration",params:{machine:n}})}},created(){this.textileMachineService=new w,this.textileMachineService.getAll().then(n=>{this.textileMachines=n.data.map(e=>new C(e)),console.log(this.textileMachines)}).catch(n=>{console.log(n)})}},se={class:"card"},ne={id:"header"},ie={id:"content",class:"template-content"},le=["onClick"];function oe(n,e,d,c,l,a){return o(),r("div",se,[(o(!0),r(u,null,m(l.textileMachines,s=>(o(),r("div",{class:"flex",key:s.id},[t("div",ne,[t("h3",null,i(s.name)+" - "+i(s.number_machine),1)]),t("div",ie,[t("span",null,i(n.$t("monitoring.status"))+": "+i(s.status),1),t("span",null,i(n.$t("monitoring.floor"))+": "+i(s.floor),1),t("span",null,i(n.$t("monitoring.zone"))+": "+i(s.zone),1),t("span",null,i(n.$t("monitoring.date-installation"))+": "+i(s.date_installation),1)]),e[0]||(e[0]=t("br",null,null,-1)),t("i",{class:"pi pi-cog",style:{"font-size":"20px",cursor:"pointer"},onClick:h=>a.goToConfiguration(s)},null,8,le)]))),128))])}const ae=M(te,[["render",oe],["__scopeId","data-v-385d539b"]]),re={props:{machines:{type:Array,required:!0}},data(){return{selectedMachineId:null,description:"",status:"pending"}},methods:{addTask(){const n={id:Date.now(),machineId:this.selectedMachineId,description:this.description,status:this.status};this.$emit("task-added",n),this.$emit("close")}}},de={class:"modal"},ue={class:"modal-content"},ce=["value"];function me(n,e,d,c,l,a){return o(),r("div",de,[t("div",ue,[e[10]||(e[10]=t("h3",null,"Añadir Tarea",-1)),t("form",{onSubmit:e[4]||(e[4]=I((...s)=>a.addTask&&a.addTask(...s),["prevent"]))},[t("div",null,[e[5]||(e[5]=t("label",{for:"machine"},"Máquina:",-1)),_(t("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>l.selectedMachineId=s),id:"machine",required:""},[(o(!0),r(u,null,m(d.machines,s=>(o(),r("option",{key:s.id,value:s.id},i(s.name)+" (ID: "+i(s.id)+") ",9,ce))),128))],512),[[y,l.selectedMachineId]])]),t("div",null,[e[6]||(e[6]=t("label",{for:"description"},"Descripción:",-1)),_(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>l.description=s),id:"description",type:"text",required:""},null,512),[[F,l.description]])]),t("div",null,[e[8]||(e[8]=t("label",{for:"status"},"Estado:",-1)),_(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.status=s),id:"status",required:""},e[7]||(e[7]=[t("option",{value:"pending"},"Pendiente",-1),t("option",{value:"in-progress"},"En Progreso",-1),t("option",{value:"completed"},"Completada",-1)]),512),[[y,l.status]])]),e[9]||(e[9]=t("button",{type:"submit"},"Guardar",-1)),t("button",{type:"button",onClick:e[3]||(e[3]=s=>n.$emit("close"))},"Cancelar")],32)])])}const he=M(re,[["render",me],["__scopeId","data-v-8e36410c"]]),pe={name:"textilMachine-management",components:{TextileMachineList:ae,PvButton:V,TextilMachineCreateComponent:D,TextilMachineSearchContent:ee,DataManager:N,AddTaskModal:he},data(){return{showForm:!1,showTaskModal:!1,selectedMachineId:null,tasks:[],machines:[]}},methods:{handleSave(){this.showForm=!1},openTaskModal(){this.showTaskModal=!0},closeTaskModal(){this.showTaskModal=!1},addTask(){this.tasks.push({})},fetchMachines(){new w().getAll().then(e=>{this.machines=e.data.map(d=>new C(d))})},getTasksForMachine(n){return this.tasks.filter(e=>e.machineId===n)}},created(){this.fetchMachines()}},ve={class:"centered-button"},fe={style:{color:"#1a1a1a"}},ke={class:"task-list"},_e={class:"task-details"},Me={class:"task-description"},be={class:"task-status"};function we(n,e,d,c,l,a){const s=v("textil-machine-search-content"),h=v("pv-button"),$=v("textil-machine-create-component"),q=v("textile-machine-list"),L=v("AddTaskModal");return o(),r(u,null,[k(s),t("div",null,[k(h,{role:"button",type:"button",class:"btn-add-sensor",onClick:e[0]||(e[0]=p=>l.showForm=!0)},{default:x(()=>[t("h3",null,i(n.$t("add"))+" "+i(n.$t("new"))+" "+i(n.$t("machine")),1),e[2]||(e[2]=t("i",{class:"pi pi-plus"},null,-1))]),_:1})]),t("div",ve,[k(h,{role:"button",type:"button",class:"btn-add-task",onClick:a.openTaskModal},{default:x(()=>e[3]||(e[3]=[t("h3",null,"Añadir Tarea",-1),t("i",{class:"pi pi-plus"},null,-1)])),_:1},8,["onClick"])]),l.showForm?(o(),T($,{key:0,visible:l.showForm,onCancelRequested:e[1]||(e[1]=p=>l.showForm=!1),onSaveRequested:a.handleSave},null,8,["visible","onSaveRequested"])):S("",!0),t("h2",fe,i(n.$t("monitoring.featured-machines")),1),k(q),l.showTaskModal?(o(),T(L,{key:1,machines:l.machines,onClose:a.closeTaskModal,onTaskAdded:a.addTask},null,8,["machines","onClose","onTaskAdded"])):S("",!0),t("div",ke,[e[4]||(e[4]=t("h2",null,"Lista de Tareas",-1)),(o(!0),r(u,null,m(l.machines,p=>(o(),r("div",{key:p.id,class:"machine-task-group"},[t("h3",null,"Máquina "+i(p.name)+" (ID: "+i(p.id)+")",1),t("ul",null,[(o(!0),r(u,null,m(a.getTasksForMachine(p.id),b=>(o(),r("li",{key:b.id,class:"task-item"},[t("div",_e,[t("span",Me,i(b.description),1),t("span",be,i(b.status),1)])]))),128))])]))),128))])],64)}const Fe=M(pe,[["render",we],["__scopeId","data-v-c07dd9c2"]]);export{Fe as default};
