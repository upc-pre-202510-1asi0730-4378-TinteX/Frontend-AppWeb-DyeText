import{a as R}from"./index-xsH4HHeE.js";import{D as g}from"./data-manager.component-CFoI-hvr.js";import{C as S}from"./create-and-edit.component-WISuARUW.js";import{_ as I,e as A,w as u,a as d,b as a,d as c,n as b,o as _,c as q}from"./index-PoYZxlwP.js";class f{constructor({id:e="",message:s="",dateTime:r="",textilMachine:i="",markAsRead:n=!1}={}){this.id=e,this.message=s,this.dateTime=r,this.textilMachine=i,this.markAsRead=n}}const y="http://localhost:3000",h="/notifications";class E{constructor(){this.api=R.create({baseURL:y,headers:{"Content-Type":"application/json"}})}getAll(){return this.api.get(h)}create(e){return this.api.post(h,e)}update(e,s){return this.api.put(`${h}/${e}`,s)}delete(e){return this.api.delete(`${h}/${e}`)}}const D={name:"notification-item-create-and-edit-dialog",components:{CreateAndEdit:S},props:{item:Object,visible:Boolean,edit:Boolean},emits:["cancel-requested","save-requested","update:visible"],data(){return{localItem:{id:"",message:"",dateTime:"",textilMachine:"",markAsRead:!1,...this.item},submitted:!1}},watch:{item:{immediate:!0,handler(t){this.localItem={id:"",message:"",dateTime:"",textilMachine:"",markAsRead:!1,...t}}}},methods:{onCancelRequested(){this.$emit("update:visible",!1),this.$emit("cancel-requested")},onSaveRequested(){this.submitted=!0,this.$emit("save-requested",{...this.localItem}),this.$emit("update:visible",!1)}}},V={class:"form-content"},C={class:"field"},w={class:"field"},x={class:"field"},k={class:"field checkbox-field"};function T(t,e,s,r,i,n){const o=c("pv-input-text"),m=c("pv-float-label"),p=c("pv-checkbox"),v=c("create-and-edit");return _(),A(v,{visible:s.visible,entity:i.localItem,"entity-name":"Notification",edit:s.edit,"onUpdate:visible":e[4]||(e[4]=l=>t.$emit("update:visible",l)),onCancelActionRequested:n.onCancelRequested,onSaveActionRequested:n.onSaveRequested},{content:u(()=>[d("div",V,[d("div",C,[a(m,null,{default:u(()=>[e[5]||(e[5]=d("label",{for:"message"},"Message",-1)),a(o,{id:"message",modelValue:i.localItem.message,"onUpdate:modelValue":e[0]||(e[0]=l=>i.localItem.message=l),class:b({"p-invalid":i.submitted&&!i.localItem.message})},null,8,["modelValue","class"])]),_:1})]),d("div",w,[a(m,null,{default:u(()=>[e[6]||(e[6]=d("label",{for:"dateTime"},"Date & Time",-1)),a(o,{id:"dateTime",modelValue:i.localItem.dateTime,"onUpdate:modelValue":e[1]||(e[1]=l=>i.localItem.dateTime=l),placeholder:"2025-05-15T10:45:00Z",class:b({"p-invalid":i.submitted&&!i.localItem.dateTime})},null,8,["modelValue","class"])]),_:1})]),d("div",x,[a(m,null,{default:u(()=>[e[7]||(e[7]=d("label",{for:"textilMachine"},"Textil Machine",-1)),a(o,{id:"textilMachine",modelValue:i.localItem.textilMachine,"onUpdate:modelValue":e[2]||(e[2]=l=>i.localItem.textilMachine=l)},null,8,["modelValue"])]),_:1})]),d("div",k,[a(p,{id:"markAsRead",modelValue:i.localItem.markAsRead,"onUpdate:modelValue":e[3]||(e[3]=l=>i.localItem.markAsRead=l),binary:""},null,8,["modelValue"]),e[8]||(e[8]=d("label",{for:"markAsRead"},"Mark as Read",-1))])])]),_:1},8,["visible","entity","edit","onCancelActionRequested","onSaveActionRequested"])}const M=I(D,[["render",T],["__scopeId","data-v-dd105930"]]),N={name:"notification-management",components:{DataManager:g,NotificationItemCreateAndEditDialog:M},data(){return{title:{singular:this.$t("alertSystem.notification"),plural:this.$t("alertSystem.notifications")},notifications:[],notification:new f,selectedNotifications:[],notificationService:null,createAndEditDialogIsVisible:!1,isEdit:!1,submitted:!1}},methods:{notifySuccessfulAction(t){this.$toast.add({severity:"success",summary:"Success",detail:t,life:3e3})},onNewItem(){const t=this.notifications.reduce((e,s)=>{const r=parseInt(s.id,10);return isNaN(r)?e:Math.max(e,r)},0);this.notification={id:String(t+1),message:"",dateTime:"",textilMachine:"",markAsRead:!1},this.isEdit=!1,this.submitted=!1,this.createAndEditDialogIsVisible=!0},onEditItem(t){this.notification=new f(t),this.isEdit=!0,this.submitted=!1,this.createAndEditDialogIsVisible=!0},onCancelRequested(){this.createAndEditDialogIsVisible=!1,this.submitted=!1,this.isEdit=!1},onSaveRequested(t){this.submitted=!0,!(!t.message.trim()||!t.dateTime)&&(this.notificationService.create(t).then(e=>{this.notifications.push(new f(e.data)),this.notifySuccessfulAction("Notification Created")}).catch(console.error),this.createAndEditDialogIsVisible=!1)},onDeleteSelected(t){if(!t||!t.length)return;const e=t.map(s=>s.id);Promise.all(e.map(s=>this.notificationService.delete(s))).then(()=>{this.notifications=this.notifications.filter(s=>!e.includes(s.id)),this.selectedNotifications=[],this.notifySuccessfulAction(`${e.length} notification(s) deleted`)}).catch(s=>{console.error(s),this.$toast.add({severity:"error",summary:"Error",detail:"Could not delete selected notifications",life:3e3})})},onDeleteItem(t){this.notificationService.delete(t.id).then(()=>{this.notifications=this.notifications.filter(e=>e.id!==t.id),this.notifySuccessfulAction("Notification Deleted")}).catch(e=>{console.error(e),this.$toast.add({severity:"error",summary:"Error",detail:"Could not delete notification",life:3e3})})}},created(){this.notificationService=new E,this.notificationService.getAll().then(t=>{this.notifications=t.data.map(e=>new f(e))}).catch(console.error)}},U={class:"w-full"};function B(t,e,s,r,i,n){const o=c("pv-column"),m=c("data-manager"),p=c("notification-item-create-and-edit-dialog");return _(),q("div",U,[a(m,{title:i.title,items:i.notifications,onNewItemRequested:n.onNewItem,onEditItemRequested:n.onEditItem,onDeleteItemRequested:n.onDeleteItem,onDeleteSelectedItemsRequested:n.onDeleteSelected},{"custom-columns":u(()=>[a(o,{field:"id",header:"ID",sortable:"",style:{"min-width":"12rem"}}),a(o,{field:"message",header:t.$t("alertSystem.message"),sortable:"",style:{"min-width":"24rem"}},null,8,["header"]),a(o,{field:"dateTime",header:t.$t("alertSystem.dateTime"),sortable:"",style:{"min-width":"20rem"}},null,8,["header"]),a(o,{field:"textilMachine",header:t.$t("alertSystem.textilMachine"),style:{"min-width":"20rem"}},null,8,["header"]),a(o,{field:"markAsRead",header:t.$t("alertSystem.markAsRead"),style:{"min-width":"8rem"}},null,8,["header"])]),_:1},8,["title","items","onNewItemRequested","onEditItemRequested","onDeleteItemRequested","onDeleteSelectedItemsRequested"]),a(p,{edit:i.isEdit,item:i.notification,visible:i.createAndEditDialogIsVisible,"onUpdate:visible":e[0]||(e[0]=v=>i.createAndEditDialogIsVisible=v),onCancelRequested:n.onCancelRequested,onSaveRequested:n.onSaveRequested},null,8,["edit","item","visible","onCancelRequested","onSaveRequested"])])}const L=I(N,[["render",B]]);export{L as default};
